# THM---Metasploit-Meterpreter
××” ×–×” Meterpreter?  Meterpreter ×”×•× Payload ××ª×§×“× ×©×œ Metasploit, ×©× ×•×¢×“ ×œ×ª××•×š ×‘×ª×”×œ×™×š ×‘×“×™×§×•×ª ×—×“×™×¨×” (Penetration Testing).

<img width="754" height="345" alt="image" src="https://github.com/user-attachments/assets/49cd6945-86d0-4bd9-bf0a-2f687cc73859" />



ğŸ“˜ ××‘×•× ×œ-Meterpreter (×‘-Metasploit)
msfvenom --list payloads | grep meterpreter


×”×¤×§×•×“×” ×”×–×• ××¦×™×’×” ××ª ×›×œ ×”-Payloads ××¡×•×’ Meterpreter ×”×–××™× ×™× ×‘-Metasploit.

ğŸ”¹ ××” ×–×” Meterpreter?

Meterpreter ×”×•× Payload ××ª×§×“× ×©×œ Metasploit, ×©× ×•×¢×“ ×œ×ª××•×š ×‘×ª×”×œ×™×š ×‘×“×™×§×•×ª ×—×“×™×¨×” (Penetration Testing).

×œ××—×¨ × ×™×¦×•×œ ××•×¦×œ×— ×©×œ ×¤×’×™×¢×•×ª:

Meterpreter ×¨×¥ ×¢×œ ××—×©×‘ ×”×™×¢×“

×•××ª×¤×§×“ ×›Ö¾Agent (×¡×•×›×Ÿ) ×‘×ª×•×š ××¨×›×™×˜×§×˜×•×¨×ª Command & Control (C2)

×‘×××¦×¢×•×ª×• × ×™×ª×Ÿ:

×œ×ª×§×©×¨ ×¢× ××¢×¨×›×ª ×”×”×¤×¢×œ×” ×©×œ ×”×™×¢×“

×œ×’×©×ª ×œ×§×‘×¦×™×

×œ×”×¨×™×¥ ×¤×§×•×“×•×ª ×™×™×¢×•×“×™×•×ª ×©×œ Meterpreter

×œ×‘×¦×¢ ×¤×¢×•×œ×•×ª ××ª×§×“××•×ª ×‘×¦×•×¨×” ×¡××•×™×” ×™×—×¡×™×ª

ğŸ”¹ ×’×¨×¡××•×ª ×©×œ Meterpreter

×™×© ××¡×¤×¨ ×’×¨×¡××•×ª ×©×œ Meterpreter, ×•×›×œ ××—×ª ××•×ª×××ª ×œ××¢×¨×›×ª ×™×¢×“ ×©×•× ×”:

Windows

Linux

macOS

Android

×•×¢×•×“

ğŸ“Œ ×›×œ ×’×¨×¡×” ××¡×¤×§×ª ×™×›×•×œ×•×ª ×©×•× ×•×ª ×‘×”×ª×× ×œ××¢×¨×›×ª ×”×”×¤×¢×œ×” ×•×”××¨×›×™×˜×§×˜×•×¨×”.

ğŸ”¹ ××™×š Meterpreter ×¢×•×‘×“? (×”×—×œ×§ ×”×—×©×•×‘)
ğŸ§  ×¢×™×§×¨×•×Ÿ ××¨×›×–×™:

Meterpreter ×œ× ××•×ª×§×Ÿ ×¢×œ ×”×“×™×¡×§ â€“ ×”×•× ×¨×¥ ×‘×–×™×›×¨×•×Ÿ (RAM)

ğŸ”¸ ×¨×™×¦×” ×‘×–×™×›×¨×•×Ÿ (In-Memory Execution)

Meterpreter:

âŒ ×œ× ×™×•×¦×¨ ×§×•×‘×¥ ×›××• meterpreter.exe

âŒ ×œ× × ×›×ª×‘ ×œ×“×™×¡×§

âœ… ×¨×¥ ×™×©×™×¨×•×ª ×‘×–×™×›×¨×•×Ÿ (RAM)

ğŸ“Œ ×œ××” ×–×” ×—×©×•×‘?

×¨×•×‘ ×ª×•×›× ×•×ª ×”×× ×˜×™Ö¾×•×™×¨×•×¡:

×¡×•×¨×§×•×ª ×§×‘×¦×™× ×—×“×©×™× ×©× ×›×ª×‘×™× ×œ×“×™×¡×§

×”×¨×‘×” ×¤×—×•×ª ××¤×§×˜×™×‘×™×•×ª ×‘×–×™×”×•×™ ×§×•×“ ×©×¨×¥ ×¨×§ ×‘×–×™×›×¨×•×Ÿ

â¡ï¸ ×›×š Meterpreter ××¤×—×™×ª ×¡×™×›×•×™ ×œ×–×™×”×•×™.

ğŸ”¸ ×”×ª×—××§×•×ª ××–×™×”×•×™ ×¨×©×ª (IDS / IPS)

Meterpreter:

×™×•×¦×¨ ×ª×§×©×•×¨×ª ××•×¦×¤× ×ª (TLS) ×¢× ××—×©×‘ ×”×ª×•×§×£

×œ×¨×•×‘ ××©×ª××© ×‘×¤×¨×•×˜×•×§×•×œ×™× ×›××• HTTPS

ğŸ“Œ ×× ×”××¨×’×•×Ÿ:

âŒ ×œ× ××¤×¢× ×— ×ª×¢×‘×•×¨×” ××•×¦×¤× ×ª

âŒ ×œ× ××‘×¦×¢ Deep Packet Inspection

â¡ï¸ ××¢×¨×›×•×ª IDS / IPS ×œ× ×™×•×›×œ×• ×œ×¨××•×ª ××” ×‘×××ª ×¢×•×‘×¨ ×‘×ª×§×©×•×¨×ª.

ğŸ”¹ ×¡×™×›×•× ×‘×™× ×™×™× â€“ ×œ××” Meterpreter × ×—×©×‘ "×—××§× ×™"?

âœ” ×¨×¥ ×‘×–×™×›×¨×•×Ÿ ×‘×œ×‘×“
âœ” ×œ× ××©××™×¨ ×§×•×‘×¥ ×—×©×•×“
âœ” ××©×ª××© ×‘×ª×§×©×•×¨×ª ××•×¦×¤× ×ª
âœ” ××•×¡×•×•×” ×›×ª×”×œ×™×š ×œ×’×™×˜×™××™

âš ï¸ ×—×©×•×‘ ×œ×“×¢×ª:

×× ×˜×™Ö¾×•×™×¨×•×¡×™× ××•×“×¨× ×™×™× ×›×Ÿ ××–×”×™× Meterpreter
××‘×œ ×”×× ×’× ×•× ×™× ×”××œ×• × ×•×ª× ×™× ×¨××ª Stealth ××¡×•×™××ª, ×œ× ×‘×œ×ª×™ × ×¨××™×ª.

ğŸ”¹ ×“×•×’××” ××¢×©×™×ª â€“ ×–×™×”×•×™ ×ª×”×œ×™×š Meterpreter

×‘×“×•×’××”:

×‘×•×¦×¢ × ×™×¦×•×œ ×©×œ ×”×¤×’×™×¢×•×ª MS17-010 (EternalBlue)

Meterpreter ×¨×¥ ×¢× PID ××¡×¤×¨ 1304

ğŸ”¸ ×‘×“×™×§×ª PID ×©×œ Meterpreter
meterpreter > getpid
Current pid: 1304


ğŸ“Œ PID = Process ID
××¡×¤×¨ ×™×™×—×•×“×™ ×©××¢×¨×›×ª ×”×”×¤×¢×œ×” × ×•×ª× ×ª ×œ×›×œ ×ª×”×œ×™×š.

ğŸ”¸ ×”×¦×’×ª ×›×œ ×”×ª×”×œ×™×›×™× ×‘××¢×¨×›×ª
meterpreter > ps


ğŸ” ××” ×¨×•××™×?

PID 1304 ×œ× × ×§×¨× meterpreter.exe

×”×•× ××•×¤×™×¢ ×›Ö¾spoolsv.exe

ğŸ“Œ spoolsv.exe ×”×•× ×ª×”×œ×™×š ×œ×’×™×˜×™××™ ×©×œ Windows (×©×™×¨×•×ª ×”×“×¤×¡×”)

â¡ï¸ Meterpreter ××•×–×¨×§ (Injected) ×œ×ª×•×š ×ª×”×œ×™×š ×§×™×™×.

ğŸ”¹ ×‘×“×™×§×ª DLLs ×©×œ ×”×ª×”×œ×™×š

×’× ×× × ×‘×“×•×§ ××ª ×”×¡×¤×¨×™×•×ª ×©× ×˜×¢× ×• ×¢"×™ ×”×ª×”×œ×™×š:

tasklist /m /fi "pid eq 1304"


ğŸ” ×”×ª×•×¦××”:

×¨×©×™××” ××¨×•×›×” ×©×œ DLLs ×¡×˜× ×“×¨×˜×™×™×

âŒ ××™×Ÿ meterpreter.dll

âŒ ××™×Ÿ ××©×”×• ×©×¦×•×¢×§ "× ×•×–×§×”"

ğŸ“Œ ×–×• ×“×•×’××” ××¦×•×™× ×ª ×œ×”×¡×•×•××” ×‘×¨××ª ××¢×¨×›×ª ×”×”×¤×¢×œ×”.

ğŸ“˜ Meterpreter Flavors â€“ ×¡×•×’×™ Meterpreter

×›×¤×™ ×©× ×œ××“ ×‘×¤×¨×§×™ Metasploit ×”×§×•×“××™×,
Payloads ×©×œ Metasploit ××ª×—×œ×§×™× ×œ×©×ª×™ ×§×˜×’×•×¨×™×•×ª ×¢×™×§×¨×™×•×ª:

ğŸ”¹ 1. Payload Inline (Single)

× ×©×œ×— ×œ×™×¢×“ ×‘×©×œ×‘ ××—×“

×¤×©×•×˜ ×™×•×ª×¨

×’×“×•×œ ×™×•×ª×¨ ×‘×’×•×“×œ

×¤×—×•×ª ×’××™×©

ğŸ”¹ 2. Payload Staged

× ×©×œ×— ×œ×™×¢×“ ×‘×©× ×™ ×©×œ×‘×™×

Stager ×§×˜×Ÿ (×˜×¢×™× ×” ×¨××©×•× ×™×ª)

×˜×¢×™× ×ª ×”-Payload ×”××œ×

×™×ª×¨×•×Ÿ: Payload ×¨××©×•× ×™ ×§×˜×Ÿ â†’ ×¤×—×•×ª ×—×©×•×“

× ×¤×•×¥ ×××•×“ ×‘-Meterpreter

ğŸ“Œ ×’× Meterpreter ×§×™×™× ×‘×’×¨×¡××•×ª:

Inline (stageless)

Staged

ğŸ”¹ ×¡×•×’×™ Meterpreter ×œ×¤×™ ××¢×¨×›×ª ×™×¢×“

Meterpreter ××’×™×¢ ×‘×’×¨×¡××•×ª ×¨×‘×•×ª, ×‘×”×ª×× ×œ×¤×œ×˜×¤×•×¨××”:

Android

Apple iOS

Java

Linux

macOS (OSX)

PHP

Python

Windows

ğŸ”¹ ××™×š ×¨×•××™× ××™×œ×• Meterpreter ×§×™×™××™×?

×‘×××¦×¢×•×ª msfvenom:

msfvenom --list payloads | grep meterpreter


ğŸ“Œ ×”×¤×§×•×“×”:

××¦×™×’×” ×¨×§ payloads ×©×œ Meterpreter

×××¤×©×¨×ª ×œ×”×‘×™×Ÿ:

××™×œ×• ××¢×¨×›×•×ª × ×ª××›×•×ª

××™×–×” ×¡×•×’ ×—×™×‘×•×¨ (TCP / HTTP / HTTPS)

×”×× payload staged ××• stageless

ğŸ”¹ ××™×š ×‘×•×—×¨×™× ××™×–×” Meterpreter ×œ×”×©×ª××©?

×”×‘×—×™×¨×” ×ª×œ×•×™×” ×‘Ö¾3 ×’×•×¨××™× ××¨×›×–×™×™×:

1ï¸âƒ£ ××¢×¨×›×ª ×”×”×¤×¢×œ×” ×©×œ ×”×™×¢×“

Windows?

Linux?

Android?

macOS?

2ï¸âƒ£ ×¨×›×™×‘×™× ×–××™× ×™× ×‘×™×¢×“

×”×× ××•×ª×§×Ÿ Python?

×”×× ×–×” ×©×¨×ª PHP?

×”×× ×™×© Java?

ğŸ“Œ ×“×•×’××”:

××ª×¨ PHP â†’ payload ××‘×•×¡×¡ PHP

×©×¨×ª Linux ×œ×œ× GUI â†’ payload CLI

3ï¸âƒ£ ×¡×•×’ ×—×™×‘×•×¨×™ ×”×¨×©×ª ×”××¤×©×¨×™×™×

×”×× TCP ×¤×ª×•×—?

×”×× ×¨×§ HTTPS ×™×•×¦× ×”×—×•×¦×”?

×”×× IPv6 ×¤×—×•×ª ×× ×•×˜×¨ ×-IPv4?

ğŸ“Œ ×“×•×’××”:

×¨×©×ª ××¨×’×•× ×™×ª â†’ reverse_https × ×¤×•×¥ ×××•×“

NAT â†’ Reverse ×•×œ× Bind

ğŸ”¹ Payload ×‘×¨×™×¨×ª ××—×“×œ ×©×œ Exploit

×—×œ×§ ××”-Exploits:

××’×™×¢×™× ×¢× Payload ×‘×¨×™×¨×ª ××—×“×œ

×œ×“×•×’××”:

use exploit/windows/smb/ms17_010_eternalblue


×¤×œ×˜:

Using configured payload windows/x64/meterpreter/reverse_tcp


ğŸ“Œ ×›×œ×•××¨:

Exploit ×›×‘×¨ ×‘×—×¨ Payload ×©××ª××™×

××‘×œ ××¤×©×¨ ×œ×©× ×•×ª ××•×ª×•

ğŸ”¹ ×”×¦×’×ª Payloads ×ª×•×××™× ×œ-Exploit
show payloads


ğŸ“Œ ×–×” ×§×¨×™×˜×™:

×œ× ×›×œ Payload ××ª××™× ×œ×›×œ Exploit

Metasploit ××¡× ×Ÿ ××•×˜×•××˜×™×ª Payloads ×œ× ×ª×•×××™×

ğŸ“˜ ×¤×§×•×“×•×ª Meterpreter â€“ ××‘×•×

×‘×›×œ Session ×©×œ Meterpreter:

meterpreter > help


ğŸ“Œ ×”×¤×§×•×“×” ×ª×¦×™×’:

×›×œ ×”×¤×§×•×“×•×ª ×”×–××™× ×•×ª

××—×•×œ×§×•×ª ×œ×¤×™ ×§×˜×’×•×¨×™×•×ª

âš ï¸ ×—×©×•×‘:

×œ× ×›×œ ×¤×§×•×“×” ×ª×¢×‘×•×“ ×‘×›×œ ××¢×¨×›×ª
×ª×œ×•×™ ×‘-OS, ×”×¨×©××•×ª, ×•×’×¨×¡×ª Meterpreter

ğŸ”¹ ×§×˜×’×•×¨×™×•×ª ×¤×§×•×“×•×ª ×¢×™×§×¨×™×•×ª

Core Commands

File System Commands

Networking Commands

System Commands

User Interface Commands

Webcam / Audio Commands

Privilege Escalation

Password & Hash Commands

ğŸ“˜ ×¤×§×•×“×•×ª Core (×”×—×©×•×‘×•×ª ×‘×™×•×ª×¨)
×¤×§×•×“×”	×”×¡×‘×¨
background	××—×–×™×¨ ×œ-msfconsole
exit	×¡×•×’×¨ Session
guid	××–×”×” ×™×™×—×•×“×™ ×œ-Session
help	×ª×¤×¨×™×˜ ×¢×–×¨×”
load	×˜×¢×™× ×ª ×”×¨×—×‘×•×ª
migrate	××¢×‘×¨ ×œ×ª×”×œ×™×š ××—×¨
sessions	××¢×‘×¨ ×‘×™×Ÿ Sessions
ğŸ“˜ ×¤×§×•×“×•×ª ××¢×¨×›×ª (System)
×¤×§×•×“×”	×”×¡×‘×¨
getuid	×‘××™×–×” ××©×ª××© ×× ×—× ×• ×¨×¦×™×
getpid	PID × ×•×›×—×™
ps	×¨×©×™××ª ×ª×”×œ×™×›×™×
kill	×¡×™×•× ×ª×”×œ×™×š
execute	×”×¨×¦×ª ×¤×§×•×“×”
shell	×¤×ª×™×—×ª CMD ×¨×’×™×œ
sysinfo	××™×“×¢ ×¢×œ ××¢×¨×›×ª
reboot / shutdown	×©×œ×™×˜×” ×‘××¢×¨×›×ª
ğŸ”¹ ×‘×“×™×§×ª ×”×¨×©××•×ª â€“ getuid
meterpreter > getuid


×¤×œ×˜:

NT AUTHORITY\SYSTEM


ğŸ“Œ ×–×” ××•××¨:

×”×¨×©××•×ª SYSTEM

×¨××ª ×©×œ×™×˜×” ××§×¡×™××œ×™×ª ×‘-Windows

ğŸ”¹ ×¨×©×™××ª ×ª×”×œ×™×›×™× â€“ ps
meterpreter > ps


ğŸ“Œ ×©×™××•×©×™×:

×œ×¨××•×ª ×ª×”×œ×™×›×™× ×¤×¢×™×œ×™×

×œ××¦×•× ×ª×”×œ×™×š ×™×¦×™×‘ ×œ-Migration

×œ×–×”×•×ª ×ª×”×œ×™×›×™× ×©×œ ××©×ª××©×™×

ğŸ“˜ migrate â€“ ××¢×‘×¨ ×‘×™×Ÿ ×ª×”×œ×™×›×™×
meterpreter > migrate <PID>


ğŸ“Œ ×œ××” ×¢×•×©×™× migrate?

×™×¦×™×‘×•×ª Session

×’×™×©×” ×œ×¤×•× ×§×¦×™×•×ª (×›××• keylogger)

×”×ª×—××§×•×ª ××–×™×”×•×™

âš ï¸ ××–×”×¨×” ×—×©×•×‘×”:

××¢×‘×¨ ××ª×”×œ×™×š SYSTEM â†’ ×ª×”×œ×™×š ××©×ª××©
×¢×œ×•×œ ×œ×”×•×¨×™×“ ×”×¨×©××•×ª ×•×œ× × ×™×ª×Ÿ ×ª××™×“ ×œ×©×—×–×¨

ğŸ“˜ hashdump â€“ ×©×œ×™×¤×ª ×¡×™×¡×××•×ª
meterpreter > hashdump


ğŸ“Œ ××” ×–×” ×¢×•×©×”?

×©×•×œ×£ ××ª SAM database

××—×–×™×¨ Hashes ××¡×•×’ NTLM

ğŸ“Œ ×©×™××•×©×™×:

Pass-the-Hash

Rainbow Tables

×–×™×”×•×™ ×¡×™×¡×××•×ª ×—×œ×©×•×ª

ğŸ“˜ search â€“ ×—×™×¤×•×© ×§×‘×¦×™×
meterpreter > search -f flag2.txt


ğŸ“Œ ×©×™××•×©×™×:

CTF â†’ ××¦×™××ª flags

PT ×××™×ª×™ â†’ ××¦×™××ª:

×§×‘×¦×™ config

×¡×™×¡×××•×ª

××™×“×¢ ×¨×’×™×©

ğŸ“˜ shell â€“ ××¢×‘×¨ ×œ-CMD ×¨×’×™×œ
meterpreter > shell


ğŸ“Œ ××” ×–×” × ×•×ª×Ÿ?

×¡×‘×™×‘×ª CMD ×¨×’×™×œ×”

×¤×§×•×“×•×ª Windows ×¨×’×™×œ×•×ª

ğŸ” ×—×–×¨×” ×œ-Meterpreter:

CTRL + Z

ğŸ§  ×¡×™×›×•× ×œ×©×™× ×•×Ÿ

âœ” Meterpreter = Payload ××ª×§×“×
âœ” ××•×ª×× ×œ×¤×œ×˜×¤×•×¨××•×ª ×©×•× ×•×ª
âœ” ×ª×•××š ×‘-Post Exploitation
âœ” ×›×•×œ×œ File, Network, System, Privilege
âœ” migrate ×•-hashdump ×”× ×›×œ×™× ×§×¨×™×˜×™×™×
âœ” ×ª××™×“ ×œ×”×¨×™×¥ help ×•×œ×‘×“×•×§ ××” ×–××™×Ÿ



<img width="924" height="840" alt="image" src="https://github.com/user-attachments/assets/2730fa78-bb45-4050-8c4e-309c3fa331ef" />





